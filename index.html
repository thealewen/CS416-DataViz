<!DOCTYPE html>
<html>
     
<head>
     <title>Narrative of World Energy Consumption</title>
 
</head>

<script src='https://d3js.org/d3.v4.min.js'></script>

<style>
     body {background-color: lightgreen;}
</style>

<body>
     <div id='title'>
          <h1 style="text-align:center">World Energy Consumption throughout 1965-2023</h1>
     </div>

     <button onclick=“world()“> The Whole World </button>
     <button onclick=“america()“> America </button>
     <button onclick=“africa()“> Africa </button>
     <button onclick=“mideast()“> Middle East </button>
     <button onclick=“cis()“> CIS </button>
     <button onclick=“europe()“> Europe </button>
     <button onclick=“asiapac()“> Asia Pacific </button>

     <div id="g1"></div>
     <svg width=500 height=500></svg>
     <script>
          d3.csv("data/wec.csv", function(data) {
              console.log(data);
          });
          // d3.csv("data/wec.csv").then(function (data) => {

          //      function convertToLongFormat(data) {
          //        // Extract years (column names) except 'Country'
          //        const years = Object.keys(data[0]).filter(key => key !== 'Country');
                 
          //        // Convert to long format
          //        const longData = data.flatMap(d => 
          //            years.map(year => ({
          //                Country: d.Country,
          //                Year: +year, // Convert year to a number
          //                Value: d[year]
          //            }))
          //        );
                 
          //        return longData;
          //    }
          // set the dimensions and margins of the graph
     
     // append the svg object to the body of the page
       //    const svg = d3.select("#g1")
       // .append("svg")
       //   .attr("width", width + margin.left + margin.right)
       //   .attr("height", height + margin.top + margin.bottom)
       // .append("g")
       //   .attr("transform", `translate(${margin.left},${margin.top})`);
     
             // Set up scales
             const xScale = d3.scaleLinear()
                 .domain(d3.extent(longData, d => d.Year))
                 .range([0, width - margin.left - margin.right]);
     
             const yScale = d3.scaleLinear()
                 .domain([0, d3.max(longData, d => d.Value)])
                 .nice()
                 .range([height - margin.top - margin.bottom, 0]);

               const xAxis = d3.axisBottom(xScale)
              .tickFormat(d3.format("~s"));
          
               const yAxis = d3.axisLeft(yScale)
               .tickFormat(d3.format("~s"));

               d3.select("svg").append("g").call(xAxis).call(yAxis);
     
             // Set up line generator
             const line = d3.line()
                 .x(d => xScale(d.Year))
                 .y(d => yScale(d.Value));
     
             // // Group data by country
             const countries = d3.group(longData, d => d.Country);
     
             // Add lines
             countries.forEach(([country, data]) => {
                 svg.append("path")
                     .datum(data)
                     .attr("class", "line")
                     .attr("d", line)
                     .style("stroke", country === "USA" ? "blue" : "red") // Set color for each country
                     .attr("stroke-width", 2)
                     .attr("fill", "none");
             });
     
             // Add X and Y axes
             svg.append("g")
                 .attr("transform", `translate(0,${height - margin.top - margin.bottom})`)
                 .call(d3.axisBottom(xScale).ticks(5).tickFormat(d3.format("d")))
                 .append("text")
                 .attr("x", width - margin.left - margin.right)
                 .attr("y", -6)
                 .attr("fill", "#000")
                 .attr("class", "axis-label")
                 .attr("text-anchor", "end")
                 .text("Year");
     
             svg.append("g")
                 .call(d3.axisLeft(yScale))
                 .append("text")
                 .attr("x", 6)
                 .attr("y", 6)
                 .attr("dy", ".71em")
                 .attr("fill", "#000")
                 .attr("class", "axis-label")
                 .attr("text-anchor", "end")
                 .text("Value");
     
             // // Convert data
             // const longData = convertToLongFormat(wideData);
          });
          
           
     </script>


     
     <div id='source'>
          <p>
               Data Source: <a href="https://www.kaggle.com/datasets/patricklford/world-energy-consumption">Kaggle</a>
          </p>
     </div>
     
</body>


</html>
